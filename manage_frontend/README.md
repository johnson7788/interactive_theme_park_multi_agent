# é˜¿æ´¾æœ—åˆ›é€ åŠ›ä¹å›­ - ç®¡ç†åå°

## åŠŸèƒ½ç‰¹ç‚¹

- ğŸ® æ¸¸æˆä¸»é¢˜ç®¡ç†
- ğŸ‘¤ NPCè§’è‰²é…ç½®
- ğŸ“ AIæ•…äº‹ç”Ÿæˆ
- âœ… ä»»åŠ¡æ¨¡æ¿ç®¡ç†
- ğŸ“ æ‰“å¡ç‚¹é…ç½®
- ğŸ‘¥ ç”¨æˆ·ç®¡ç†
- ğŸ å¥–åŠ±è®¾ç½®
- ğŸ“Š æ•°æ®ç»Ÿè®¡
- ğŸ” ç”¨æˆ·ç™»å½•è®¤è¯

## å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¾èµ–

```bash
npm install
```

### é…ç½®ç¯å¢ƒå˜é‡

å¤åˆ¶ `.env.example` ä¸º `.env.local`ï¼š

```bash
cp .env.example .env.local
```

ç¼–è¾‘ `.env.local` æ–‡ä»¶ï¼Œé…ç½®åç«¯APIåœ°å€ï¼š

```
NEXT_PUBLIC_API_URL=http://localhost:8000
```

### è¿è¡Œå¼€å‘æœåŠ¡å™¨

```bash
npm run dev
```

è®¿é—® [http://localhost:3000](http://localhost:3000)

## ç™»å½•è¯´æ˜

é»˜è®¤ç®¡ç†å‘˜è´¦å·éœ€è¦åœ¨åç«¯æ•°æ®åº“ä¸­åˆ›å»ºã€‚

è®¿é—®ç³»ç»Ÿæ—¶ä¼šè‡ªåŠ¨è·³è½¬åˆ°ç™»å½•é¡µé¢ `/login`ã€‚

ç™»å½•æˆåŠŸåä¼šè·³è½¬åˆ°ç®¡ç†åå° `/admin/dashboard`ã€‚

## æŠ€æœ¯æ ˆ

- **æ¡†æ¶**: Next.js 13
- **UIç»„ä»¶**: Radix UI + Tailwind CSS
- **çŠ¶æ€ç®¡ç†**: React Context
- **HTTPå®¢æˆ·ç«¯**: Fetch API
- **è®¤è¯**: JWT Token

## é¡¹ç›®ç»“æ„

```
manage_frontend/
â”œâ”€â”€ app/                    # Next.js åº”ç”¨è·¯ç”±
â”‚   â”œâ”€â”€ admin/             # ç®¡ç†åå°é¡µé¢
â”‚   â”œâ”€â”€ login/             # ç™»å½•é¡µé¢
â”‚   â”œâ”€â”€ layout.tsx         # æ ¹å¸ƒå±€
â”‚   â””â”€â”€ page.tsx           # é¦–é¡µ
â”œâ”€â”€ components/            # ç»„ä»¶
â”‚   â”œâ”€â”€ admin/            # ç®¡ç†åå°ç»„ä»¶
â”‚   â”œâ”€â”€ auth/             # è®¤è¯ç›¸å…³ç»„ä»¶
â”‚   â””â”€â”€ ui/               # UIåŸºç¡€ç»„ä»¶
â””â”€â”€ lib/                  # å·¥å…·åº“
    â”œâ”€â”€ api.ts            # APIå®¢æˆ·ç«¯
    â”œâ”€â”€ auth.ts           # è®¤è¯é€»è¾‘
    â””â”€â”€ utils.ts          # å·¥å…·å‡½æ•°
```

## æ•°æ®è®¿é—®

**æ³¨æ„**ï¼šå½“å‰ç‰ˆæœ¬ä½¿ç”¨ Supabase å®¢æˆ·ç«¯ç›´æ¥è¿æ¥æ•°æ®åº“ï¼Œè€Œéé€šè¿‡åç«¯ APIã€‚

- æ‰€æœ‰æ•°æ®æ“ä½œé€šè¿‡ `lib/supabase.ts` ä¸­çš„ Supabase å®¢æˆ·ç«¯å®Œæˆ
- `lib/api.ts` ä¸­çš„ `apiClient` ä¸ºå¤‡ç”¨æ–¹æ¡ˆï¼ˆå½“å‰æœªä½¿ç”¨ï¼‰
- å¦‚éœ€åˆ‡æ¢ä¸ºåç«¯ APIï¼Œå¯åœ¨å„é¡µé¢ä¸­å°† Supabase è°ƒç”¨æ›¿æ¢ä¸º `apiClient` è°ƒç”¨

## å¼€å‘è¯´æ˜

### æ·»åŠ æ–°é¡µé¢

1. åœ¨ `app/admin/` ä¸‹åˆ›å»ºæ–°ç›®å½•å’Œ `page.tsx`
2. åœ¨ `components/admin/sidebar.tsx` ä¸­æ·»åŠ å¯¼èˆªé“¾æ¥

### æ•°æ®æ“ä½œç¤ºä¾‹

```typescript
import { supabase } from '@/lib/supabase';

// æŸ¥è¯¢æ•°æ®
const { data, error } = await supabase
  .from('game_themes')
  .select('*')
  .order('created_at', { ascending: false });

// æ’å…¥æ•°æ®
const { error } = await supabase
  .from('game_themes')
  .insert([{ name: 'æ–°ä¸»é¢˜', description: 'æè¿°' }]);

// æ›´æ–°æ•°æ®
const { error } = await supabase
  .from('game_themes')
  .update({ name: 'æ›´æ–°ä¸»é¢˜' })
  .eq('id', 'ä¸»é¢˜ID');

// åˆ é™¤æ•°æ®
const { error } = await supabase
  .from('game_themes')
  .delete()
  .eq('id', 'ä¸»é¢˜ID');
```

## ä»£ç é€»è¾‘

### åº”ç”¨å¯åŠ¨æµç¨‹

1. **å…¥å£é¡µé¢** (`app/page.tsx`)ï¼šæ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²ç™»å½•
   - å·²ç™»å½• â†’ è·³è½¬åˆ°ç®¡ç†åå° (`/admin/dashboard`)
   - æœªç™»å½• â†’ è·³è½¬åˆ°ç™»å½•é¡µ (`/login`)

2. **æ ¹å¸ƒå±€** (`app/layout.tsx`)ï¼šåŒ…è£¹æ•´ä¸ªåº”ç”¨
   - æä¾› `AuthProvider` å…¨å±€è®¤è¯ä¸Šä¸‹æ–‡
   - æ·»åŠ  Toast æ¶ˆæ¯æç¤ºç»„ä»¶

### è®¤è¯æœºåˆ¶

1. **è®¤è¯æä¾›è€…** (`lib/auth.tsx`)ï¼š
   - ä½¿ç”¨ React Context ç®¡ç†å…¨å±€ç™»å½•çŠ¶æ€
   - Token å­˜å‚¨åœ¨ `sessionStorage`ï¼ˆå…³é—­æ ‡ç­¾é¡µåå¤±æ•ˆï¼‰
   - æä¾› `login`ã€`logout`ã€`isAuthenticated` æ–¹æ³•

2. **ç™»å½•æµç¨‹**ï¼š
   - ç”¨æˆ·è¾“å…¥è´¦å·å¯†ç  â†’ è°ƒç”¨ç™»å½•æ¥å£ â†’ ä¿å­˜ Token â†’ æ›´æ–°è®¤è¯çŠ¶æ€ â†’ è·³è½¬ç®¡ç†åå°

3. **è·¯ç”±ä¿æŠ¤** (`components/auth/protected-route.tsx`)ï¼š
   - åŒ…è£¹æ‰€æœ‰ç®¡ç†åå°é¡µé¢
   - æœªç™»å½•æ—¶è‡ªåŠ¨è·³è½¬åˆ°ç™»å½•é¡µ

### æ•°æ®è·å–æ–¹å¼

é¡¹ç›®ä½¿ç”¨ **Supabase å®¢æˆ·ç«¯**ç›´æ¥è¿æ¥æ•°æ®åº“ï¼ˆè€Œéé€šè¿‡åç«¯APIï¼‰ï¼š
- æ‰€æœ‰ç®¡ç†é¡µé¢é€šè¿‡ `supabase.from('è¡¨å').select()` è·å–æ•°æ®
- å¢åˆ æ”¹æ“ä½œç›´æ¥æ“ä½œæ•°æ®åº“è¡¨
- é…ç½®åœ¨ `lib/supabase.ts` ä¸­

### é¡µé¢ç»“æ„

**ç®¡ç†åå°å¸ƒå±€** (`app/admin/layout.tsx`)ï¼š
- å·¦ä¾§ï¼šå›ºå®šä¾§è¾¹æ å¯¼èˆªï¼ˆ`components/admin/sidebar.tsx`ï¼‰
- å³ä¾§ï¼šå†…å®¹åŒºåŸŸï¼Œæ˜¾ç¤ºå„ä¸ªç®¡ç†é¡µé¢

**ä¸»è¦ç®¡ç†é¡µé¢**ï¼š
- `dashboard`ï¼šæ•°æ®ç»Ÿè®¡ï¼Œå±•ç¤ºç”¨æˆ·æ•°ã€ä»»åŠ¡æ•°ç­‰å›¾è¡¨
- `themes`ï¼šæ¸¸æˆä¸»é¢˜ç®¡ç†ï¼ˆå¢åˆ æ”¹æŸ¥ï¼‰
- `npcs`ï¼šNPCè§’è‰²ç®¡ç†
- `tasks`ï¼šä»»åŠ¡æ¨¡æ¿ç®¡ç†
- `checkpoints`ï¼šæ‰“å¡ç‚¹é…ç½®
- `users`ï¼šç”¨æˆ·åˆ—è¡¨
- `rewards`ï¼šå¥–åŠ±è®¾ç½®
- `stories`ï¼šAIæ•…äº‹ç”Ÿæˆ
- `settings`ï¼šç³»ç»Ÿé…ç½®

### ç»„ä»¶æ¶æ„

- **UIç»„ä»¶** (`components/ui/`)ï¼šåŸºäº Radix UI çš„é€šç”¨ç»„ä»¶ï¼ˆæŒ‰é’®ã€è¡¨æ ¼ã€å¯¹è¯æ¡†ç­‰ï¼‰
- **ä¸šåŠ¡ç»„ä»¶** (`components/admin/`, `components/auth/`)ï¼šä¸šåŠ¡é€»è¾‘ç»„ä»¶
- **å·¥å…·å‡½æ•°** (`lib/utils.ts`)ï¼šé€šç”¨å·¥å…·æ–¹æ³•

### çŠ¶æ€ç®¡ç†

- ä½¿ç”¨ React Hooksï¼ˆ`useState`ã€`useEffect`ï¼‰ç®¡ç†ç»„ä»¶çŠ¶æ€
- å…¨å±€è®¤è¯çŠ¶æ€é€šè¿‡ Context API ç®¡ç†
- é¡µé¢çº§æ•°æ®é€šè¿‡ç»„ä»¶å†…çŠ¶æ€ + Supabase æŸ¥è¯¢ç®¡ç†

## æ„å»ºç”Ÿäº§ç‰ˆæœ¬

```bash
npm run build
npm run start
```
